# Manual Vulnerability Enumeration

Penetration testers and red teamers may engage in more intensive and focused scans of specific hosts or services. These scans might use off-the-shelf or custom tools. In either case, the manual initiation and review of the scan results provides a much higher degree of accuracy & validity than any automated scan.

## Distinctions from Automated Scanning

### 1. Validation

- Manual analysis significantly reduces the chance of false positives and negatives, leading to more accurate results.
- Manual scanning can go further in proving exploitability

### 2. Discovery of Vulnerabilities Not Previously Known

- Automated vulnerabilty scanners such as Nessus rely on databases of known-existing vulnerabilities
- Manual approaches may discover vulnerabilities that have not yet been found
- Automated scanners do not fully cover custom / in-house developed software solutions

### 2. Context-Awareness

- Human analysts understand the business context, which allows for more targeted and relevant vulnerability assessment.

### 4. Custom Scanning

- Ability to tailor the scan according to the unique characteristics and requirements of the specific environment.

## Case Study: Fine-Tuning SQLmap for a Specific Application

The following case study explores how a manual vulnerability enumeration approach is distinguished from automated scanning approaches. In this scenario, the presence of multiple confounding factors cause automated vulnerability scanning to fail at identifying vulnerabilities in the target, whereas a trained analyst with a focused tool is capable of going much farther.

Notice the tool performs a high degree of automation, batch testing attacks on the target in an iterative fashion and making changes accordingly. Although many steps are automated, the analyst steps in to fine tune testing behavior based on feedback and knowledge of the environment.

### Context

The target application employs a complex architecture with a load balancer, a Web Application Firewall (WAF), and rate limiting. While automated vulnerability scanners like Nessus fail to identify an SQL Injection vulnerability due to these security measures, a manual approach using SQLmap succeeds.

SQLmap is a powerful tool capable of not just identifying but exploiting SQL Injection vulnerabilities. It can be fine-tuned to adapt to specific application architectures and security measures.

### Fine-tuning SQLmap

Here are some examples of how an analyst could fine-tune SQLmap to adapt to this specific application.

#### Handling Cookies and Session Information

```bash
sqlmap -u "http://example.com/page?id=1" --cookie="JSESSIONID=ABC123" --batch
```

#### Specifying User-Agent and Referer for WAF Evasion

```bash
sqlmap -u "http://example.com/page?id=1" --headers="User-Agent: Mozilla/5.0" --referer="http://example.com/"
```

#### Tamper Scripts for Evasion Techniques

```bash
sqlmap -u "http://example.com/page?id=1" --tamper="between,randomcase,space2comment"
```

#### Rate Limit and Timing Options

```bash
sqlmap -u "http://example.com/page?id=1" --delay=1 --timeout=10
```

### Results

- Even though the application employs multiple security layers like a WAF and rate limiting, fine-tuning SQLmap allows the analyst to identify and exploit the SQL Injection vulnerability, revealing the gaps in existing security measures.
